# MemberCore - Product Requirements Document (PRD)

## ğŸ“‹ ProjektÃ¼bersicht

**MemberCore** ist ein integriertes Verwaltungs- und Marketing-System fÃ¼r Fitnessstudios, das alle geschÃ¤ftskritischen Bereiche von der Lead-Generierung bis zur Mitgliederverwaltung abdeckt.

### ğŸ¯ Hauptziele
- Zentrale Verwaltung von Leads, Mitgliedern und VertrÃ¤gen
- Automatisiertes Marketing mit Kampagnen und Landingpages
- Effiziente Mitarbeiterverwaltung mit Aufgaben-System
- Professionelle CI-gesteuerte Designvorlagen
- Sichere Passwort- und Dateiverwaltung

### ğŸ—ï¸ Technische Basis
- **Framework:** Next.js (App Router) mit TypeScript
- **Styling:** Tailwind CSS mit eigenen UI-Komponenten
- **Datenbank:** Supabase (PostgreSQL) mit Auth & Vault
- **Authentifizierung:** Supabase E-Mail + Passwort mit 2FA-Option
- **Icons:** Lucide React

---

## ğŸ¢ Rollenmodell & Berechtigungen

### Rollenhierarchie

| Rolle        | Beschreibung                                           | Zugriff                                    |
|--------------|--------------------------------------------------------|--------------------------------------------|
| **Admin**    | Vollzugriff auf alle Module + Systemeinstellungen     | Alle Module, Nutzer verwalten, Einstellungen |
| **Studioleiter** | Darf Mitarbeiter verwalten, Stunden pflegen        | Alle auÃŸer Systemeinstellungen, keine Admin-Verwaltung |
| **Mitarbeiter** | Leads & Beratungen bearbeiten, eigene Daten einsehen | Leads, Beratung, eigene Stunden, begrenzte Dateirechte |

### Sicherheitsrichtlinien
- Login via Supabase Auth (E-Mail + Passwort)
- Optional: Zwei-Faktor-Authentifizierung (2FA)
- Deaktivieren statt LÃ¶schen (Audit-fÃ¤hig)
- Row-Level-Security (RLS) fÃ¼r alle sensiblen Daten
- Rollenbasierte Dateimanager-Berechtigungen

---

## ğŸ“Š Modul 1: Dashboard & KPIs

### Zweck
Zentrale Ãœbersichtsseite mit aktuellen Kennzahlen, Kampagnenauswertungen und FrÃ¼hwarnindikatoren.

### Hauptfunktionen
- **ğŸ¯ Zielerreichung:** Fortschrittsbalken fÃ¼r Mitgliederziele
- **ğŸ“ˆ Leads Monatsziel:** Verfolgung der Lead-Generierung
- **ğŸ“Š KampagnenÃ¼bersicht:** Laufende Kampagnen mit KPIs
- **ğŸ“… Monatsvergleich:** NeuzugÃ¤nge vs. KÃ¼ndigungen
- **ğŸ“ Vertragsverteilung:** Visualisierung nach Vertragsarten
- **âš ï¸ KÃ¼ndigungswarnung:** Mitglieder mit KÃ¼ndigung <90 Tage

### Technische Details
- API-Layer fÃ¼r Dashboard-KPIs
- Serverseitige Aggregation der Daten
- Clientseitiges Caching (SWR/React Query)
- Rollenbasierte Sichtbarkeit der KPIs

---

## ğŸ‘¥ Modul 2: Leads-Management

### Tabelle: `public.leads`
| Spalte        | Typ       | Beschreibung                          |
|---------------|-----------|---------------------------------------|
| id            | UUID      | PrimÃ¤rschlÃ¼ssel                       |
| name          | TEXT      | Pflichtfeld                           |
| contact       | TEXT      | E-Mail oder Telefon                   |
| source        | TEXT      | Quelle (Social Media, Empfehlung)     |
| status        | ENUM      | open, consultation, lost, converted   |
| campaign_id   | UUID      | FK â†’ campaigns.id                     |
| firstname     | TEXT      | Optional                              |
| lastname      | TEXT      | Optional                              |
| phone         | TEXT      | Optional                              |
| email         | TEXT      | Optional                              |
| birthdate     | DATE      | Optional                              |
| member_number | TEXT      | Optional                              |

### Status-Workflow
- **open:** Neuer Lead, noch nicht bearbeitet
- **consultation:** Beratungstermin vereinbart
- **converted:** Automatisch neues Mitglied anlegen
- **lost:** Lead archiviert, keine weiteren Aktionen

### Funktionen
- Suche nach Name (unscharf)
- Filter nach Status und Kampagne
- StatusÃ¤nderung per Klick oder KontextmenÃ¼
- Lead-zu-Mitglied Konvertierung

---

## ğŸ¤ Modul 3: BeratungsgesprÃ¤che

### Tabelle: `public.consultations`
| Spalte                   | Typ       | Beschreibung                           |
|--------------------------|-----------|---------------------------------------|
| id                       | UUID      | PrimÃ¤rschlÃ¼ssel                        |
| lead_id                  | UUID      | FK â†’ leads                             |
| consultant               | TEXT      | Aktueller Benutzer                     |
| date                     | TIMESTAMP | Datum + Uhrzeit                        |
| result                   | ENUM      | contractsigned, nocontract             |
| planned_contracttype_id  | UUID      | FK â†’ contract_types                    |
| notes                    | TEXT      | Freitext-Notizen                       |

### Funktionen
- **Terminverwaltung:** Chronologische Sortierung
- **Ergebniserfassung:** bei "contractsigned" â†’ automatische Mitglieder-Erstellung
- **Auswertung:** AbschlÃ¼sse pro Vertragsart
- **Berechtigungen:** Mitarbeiter sehen nur eigene Termine

---

## ğŸ¯ Modul 4: Kampagnen-Management

### Kampagnen-Struktur
```
Campaign (Hauptkampagne)
â”œâ”€â”€ Campaign_Strand (Kanal: Meta, Google, Print)
â”‚   â”œâ”€â”€ Campaign_Action (Flyer, Anzeige, Event)
â”‚   â””â”€â”€ Campaign_Action (Landing Page, E-Mail)
â””â”€â”€ Campaign_Strand (Kanal: Inhouse)
    â””â”€â”€ Campaign_Action (Plakate, Mundpropaganda)
```

### Tabelle: `public.campaigns`
| Feld               | Typ       | Beschreibung                          |
|--------------------|-----------|---------------------------------------|
| id                 | UUID      | PrimÃ¤rschlÃ¼ssel                       |
| name               | TEXT      | Kampagnenname                         |
| description        | TEXT      | Zweck/Beschreibung                    |
| start_date         | DATE      | Startzeitraum                         |
| end_date           | DATE      | Endzeitraum                           |
| status             | ENUM      | draft, active, completed, archived    |
| campaign_type      | TEXT      | Online, Offline, Mischung             |
| objective          | TEXT      | Leads, VertrÃ¤ge, Sichtbarkeit         |
| lead_goal          | INTEGER   | Zielanzahl Leads                      |
| contract_goal      | INTEGER   | Zielanzahl VertrÃ¤ge                   |
| budget_total       | NUMERIC   | Gesamtbudget                          |
| coordinator_id     | UUID      | Referenz auf mitarbeiter.id           |

### Funktionen
- **Strang-Management:** Verschiedene KanÃ¤le organisieren
- **Aktions-Tracking:** Einzelne MaÃŸnahmen verfolgen
- **Budget-Kontrolle:** Ausgaben vs. geplantes Budget
- **Fortschritts-Monitoring:** Lead- und Vertragsziele
- **Datei-VerknÃ¼pfung:** Assets aus Dateimanager zuweisen

---

## ğŸ“ Modul 5: Dateimanager

### Tabelle: `public.file_asset`
| Feld             | Typ       | Beschreibung                          |
|------------------|-----------|---------------------------------------|
| id               | UUID      | PrimÃ¤rschlÃ¼ssel                       |
| filename         | TEXT      | UrsprÃ¼nglicher Dateiname              |
| file_url         | TEXT      | Speicherpfad (Supabase Storage)       |
| category         | ENUM      | image, graphic, document, print, template, web, video |
| type             | TEXT      | Unterkategorie (flyer, logo, testimonial) |
| work_area        | TEXT      | Trainer, Rezeption, Verwaltung, Marketing |
| campaign_id      | UUID      | Optional: Kampagnen-VerknÃ¼pfung       |
| module_reference | TEXT      | system, landingpage, task, campaign   |
| is_print_ready   | BOOLEAN   | Finale Druckdatei                     |
| tags             | TEXT[]    | Freie Schlagworte                     |
| description      | TEXT      | Einsatzzweck                          |
| created_by       | UUID      | Uploader (Mitarbeiter)                |

### Berechtigungssystem
| Berechtigung | Beschreibung           | Verhalten                             |
|-------------|------------------------|---------------------------------------|
| **none**    | Keine Upload-Berechtigung | Kann keine Dateien hochladen/sehen   |
| **own_files** | Nur eigene Dateien    | Kann eigene Dateien hochladen/verwalten |
| **all_files** | Alle Dateien         | Kann alle sichtbaren Dateien verwalten |

### Funktionen
- **Drag & Drop Upload** mit automatischer Vorschau
- **Intelligente Kategorisierung** nach Dateityp
- **Virtuelle Ordner-Struktur** basierend auf Kampagnen/Arbeitsbereichen
- **Tag-basierte Suche** und Filterung
- **Rollenbasierte Zugriffskontrolle** mit granularen Berechtigungen
- **Versionierung** Versionierung von Dokumenten

---

## ğŸ‘¥ Modul 6: Mitarbeiterverwaltung

### Tabelle: `public.staff`
| Spalte       | Typ       | Beschreibung                          |
|--------------|-----------|---------------------------------------|
| id           | UUID      | FK â†’ auth.users.id                    |
| rolle        | ENUM      | admin, studioleiter, mitarbeiter      |
| created_at   | TIMESTAMP | Erstellungszeitpunkt                  |
| updated_at   | TIMESTAMP | Letzte Ã„nderung                       |

### Tab-System
1. **Ãœbersicht-Tab:** Mitarbeiterliste mit Basis-Informationen
2. **Dateimanager-Rechte-Tab:** Berechtigungsmatrix-Verwaltung

### Dateimanager-Berechtigungen (`staff_file_permissions`)
- **Upload-Berechtigung:** none/own_files/all_files
- **Admin-Dateien-Zugriff:** Boolean-Flag
- **Automatische Rechtevergabe** basierend auf Rolle
- **Live-Updates** der Berechtigungen

### Funktionen
- **Mitarbeiter-Einladung** via Supabase E-Mail-Auth
- **Rollenbasierte Berechtigungen** mit Vererbung
- **Berechtigungsmatrix** fÃ¼r granulare Kontrolle
- **Deaktivieren statt LÃ¶schen** fÃ¼r Audit-Compliance

---

## â° Modul 7: Stundenerfassung

### Tabelle: `public.staff_hours`
| Spalte        | Typ         | Beschreibung                          |
|---------------|-------------|---------------------------------------|
| id            | UUID        | PrimÃ¤rschlÃ¼ssel                       |
| staff_id      | UUID        | FK â†’ staff                            |
| date          | DATE        | Arbeitsdatum                          |
| hours         | DECIMAL(5,2)| Gearbeitete Stunden                   |
| reason        | TEXT        | BGM-Termin, Urlaub, Krankheit         |
| vacation_days | INTEGER     | Optionale Urlaubstage                 |
| sick_days     | INTEGER     | Optionale Krankheitstage              |

### Funktionen
- **Tagesweise Erfassung** mit Validierung
- **Wochen-/Monatsansichten** mit Aggregation
- **Ampel-System:** Rot (<75%), Gelb (75-100%), GrÃ¼n (â‰¥100%)
- **Rollenbasierte Berechtigung:** Mitarbeiter nur eigene, Studioleiter alle
- **Soll/Ist-Vergleich** mit visueller Darstellung

---

## ğŸ·ï¸ Modul 8: Vertragsarten & Mitgliedschaften

### Vertragsarten (`public.contract_types`)
- **Basis-Konfiguration:** Name, Preis, Laufzeiten
- **Modulzuordnung:** VerfÃ¼gbare Services pro Vertragsart
- **Aktiv/Inaktiv-Status** fÃ¼r VerfÃ¼gbarkeit
- **Preisgestaltung** mit flexiblen Laufzeiten

### Mitgliedschaften (`public.memberships`)
- **Ein aktiver Vertrag** pro Mitglied
- **VerlÃ¤ngerungs-Workflow** mit predecessor_id
- **KÃ¼ndigungs-Management** mit Statusverfolgung
- **Restlaufzeit-Berechnung** mit Farbkodierung

---

## ğŸ” Modul 9: Passwortmanager

### Tabelle: `vault.secrets`
- **VerschlÃ¼sselte Speicherung** aller Zugangsdaten
- **Kategorisierung:** CRM, Social Media, HR-Tools
- **Berechtigungsmatrix:** sehen/bearbeiten/lÃ¶schen pro Rolle
- **Ablaufdatum-Verwaltung** mit Erinnerungsfunktion

### Sicherheitsfeatures
- **VollverschlÃ¼sselung** mit Supabase Vault
- **Rollenbasierte Sichtbarkeit** ohne Berechtigung nicht sichtbar
- **Audit-Logging** fÃ¼r alle Zugriffe
- **2FA-Information** pro Passwort-Eintrag

---

## ğŸ“‹ Modul 10: Aufgaben-System

### Tabelle: `public.task_template`
- **Aufgaben-Vorlagen** fÃ¼r wiederkehrende Prozesse
- **Auto-Trigger:** on_campaign_start, on_flyer_delivered
- **Modul-VerknÃ¼pfung:** campaign, system, landingpage

### Tabelle: `public.task_instance`
- **Aufgaben-Instanzen** mit Zuordnung zu Mitarbeitern
- **Status-Tracking:** open, in_progress, done, skipped
- **Feedback-Feld** fÃ¼r Ergebnis-Dokumentation
- **FÃ¤lligkeitsdatum** mit Ãœberwachung

### Workflow
1. **Template definieren** mit Trigger-Bedingungen
2. **Automatische Erstellung** bei Trigger-Events
3. **Mitarbeiter-Zuordnung** basierend auf Rolle/VerfÃ¼gbarkeit
4. **Status-Updates** mit Feedback-Erfassung
5. **Monitoring** im Dashboard pro Kampagne

---

## ğŸ¨ Modul 11: CI-Styling-System

### Tabelle: `public.ci_templates`
- **Design-Presets** fÃ¼r konsistente Gestaltung
- **Farbschemata:** primary, secondary, accent, background, text
- **Typografie:** font_family, font_headline, font_sizes (JSON)
- **Button-Styles:** radius, padding, hover-effects
- **Icon-Konfiguration:** style, color, shape

### Master-CI-Konzept
- **Ein Master-Template** als Basis fÃ¼r alle Designs
- **Vererbung** von Basis-Eigenschaften
- **Kampagnen-spezifische** Anpassungen mÃ¶glich
- **Logo-Verwaltung:** primary, white, black, favicon

### Integration
- **Landingpage-Builder:** Automatische Stil-Anwendung
- **Kampagnen:** CI-Zuweisung bei Erstellung
- **Dateimanager:** Logo-Upload und -Verwaltung

---

## ğŸŒ Modul 12: Landingpage-System

### Landingpage-Struktur
```
Landingpage
â”œâ”€â”€ Header-Block (Hero, Split, Image Overlay)
â”œâ”€â”€ Text-Block (Classic, Two-Column, Quote)
â”œâ”€â”€ Media-Block (Gallery, Video, Carousel)
â”œâ”€â”€ Conversion-Block (Form, Pricing, CTA)
â”œâ”€â”€ Trust-Block (Testimonials, Logos, Stats)
â””â”€â”€ Footer-Block (Contact, Map, Social)
```

### Block-Kategorien

#### Inhalts-BlÃ¶cke
- **Header:** Hero Centered, Split, Image Overlay
- **Text:** Classic Paragraph, Two-Column, Info Card
- **Bild/Video:** Lightbox Grid, YouTube Card, Wide Banner
- **Button:** Flat, Rounded, Ghost, Icon + Text

#### Funktionale BlÃ¶cke
- **Testimonials:** Card Wide, Quote Overlay, Carousel
- **Pricing:** Highlight Center, Rabatt-Badge, Mirror Compare
- **Formular:** Modern Clean, Floating Modal, Side Panel
- **Countdown:** Classic Timer, Animated, Progress Bar

#### Struktur-BlÃ¶cke
- **FAQ:** Accordion, Card Toggle, Minimal Expand
- **Kontakt:** Split Map, Overlay Map, Compact Info
- **Trust-Logos:** Logo Strip, Gray Out, Carousel
- **Statistik:** Animated Counter, Icon + Fact, Number Badge

### Design-Presets
Jeder Block hat 5 vordefinierte Design-Varianten:
- **Modern Clean:** Minimalistisch, viel WeiÃŸraum
- **Bold Impact:** Starke Farben, groÃŸe Schriften
- **Professional:** Business-orientiert, vertrauensvoll
- **Playful:** Lebendig, fÃ¼r jÃ¼ngere Zielgruppen
- **Elegant:** Hochwertig, fÃ¼r Premium-Angebote

### Dynamische Logiken
- **CI-Integration:** Globale Farben und Schriften
- **Kampagnen-Binding:** Countdown, Preise, Aktionen
- **Form-Kontext:** Automatische Lead-Zuordnung
- **Responsive Design:** Mobile-optimierte Layouts

---

## ğŸ“ Modul 13: Formbuilder

### Implementierungsstatus: âœ… VOLLSTÃ„NDIG

### Feld-Typen (18+ verfÃ¼gbar)
- **Standard:** text, email, phone, number, textarea
- **Auswahl:** select, radio, checkbox, checkbox_group
- **Datum/Zeit:** date, time
- **Spezial:** file_upload, signature, rating, slider, address
- **Layout:** heading, paragraph, divider
- **Dynamisch:** campaign_offers, contract_types, pricing_calculator

### Multi-Step-Formulare
- **Schritt-basierte Navigation** mit Fortschrittsanzeige
- **Bedingte Logik** zwischen Schritten
- **Validierung** pro Schritt und global
- **Responsive Design** fÃ¼r alle GerÃ¤te

### Analytics & Auswertung
- **Submission-Tracking** mit Zeitstempel
- **Conversion-Rates** pro Formular
- **CSV-Export** aller Daten
- **Lead-Integration** automatische Erstellung

---

## ğŸ”„ Modul-Integrationen & Workflows

### Lead-zu-Mitglied-Workflow
1. **Lead erfasst** (Formular, manuell, Import)
2. **Beratungstermin** vereinbart und durchgefÃ¼hrt
3. **Vertrag abgeschlossen** â†’ Status "converted"
4. **Mitglied automatisch angelegt** mit Vertragsdaten
5. **Willkommens-Aufgaben** automatisch erstellt

### Kampagnen-zu-Landing-Workflow
1. **Kampagne erstellt** mit CI-Template-Zuweisung
2. **Landingpage generiert** mit Kampagnen-Branding
3. **Formulare eingebettet** mit automatischer Lead-Zuordnung
4. **QR-Codes generiert** fÃ¼r Print-Materialien
5. **Analytics verknÃ¼pft** fÃ¼r ROI-Messung

### Dateimanager-Workflow
1. **Upload mit Kategorisierung** und Rechte-Zuweisung
2. **Automatische VerknÃ¼pfung** zu Kampagnen/Modulen
3. **Verwendung in Landingpages** und Print-Materialien
4. **Versionierung** fÃ¼r Design-Iterationen
5. **Archivierung** abgelaufener Assets

---

## ğŸ“Š Reporting & Analytics

### Dashboard-KPIs
- **Mitglieder-Entwicklung:** NeuzugÃ¤nge vs. KÃ¼ndigungen
- **Kampagnen-Performance:** Leads, Conversion, ROI
- **Team-ProduktivitÃ¤t:** Aufgaben-ErfÃ¼llung, Stunden
- **Vertrags-Verteilung:** Nach Art und Laufzeit

### Export-Funktionen
- **CSV-Exports** fÃ¼r alle Datentabellen
- **PDF-Berichte** fÃ¼r Management-Ãœbersichten
- **QR-Code-Generierung** fÃ¼r Kampagnen-Materialien
- **Daten-Backup** fÃ¼r Compliance

---

## ğŸ”’ Sicherheit & Compliance

### Datenschutz
- **DSGVO-konforme** Datenverarbeitung
- **EinverstÃ¤ndniserklÃ¤rungen** in Formularen
- **Recht auf LÃ¶schung** implementiert
- **Audit-Logs** fÃ¼r alle kritischen Aktionen

### Technische Sicherheit
- **Row-Level-Security (RLS)** auf Datenbankebene
- **API-Rate-Limiting** gegen Missbrauch
- **VerschlÃ¼sselte Passwort-Speicherung** in Vault
- **Session-Management** mit automatischem Logout

### Backup & Recovery
- **Automatische Backups** der Supabase-Datenbank
- **Versionierung** kritischer Konfigurationen
- **Disaster-Recovery-Plan** dokumentiert
- **Daten-Migration** zwischen Umgebungen

---

## ğŸš€ Roadmap & Erweiterungen

### Phase 1: Core-Funktionen (âœ… Abgeschlossen)
- Basis-Module implementiert
- Authentifizierung und Rollen
- Lead-Management und Beratung
- Grundlegende Kampagnen-Verwaltung

### Phase 2: Design & Content (âœ… Abgeschlossen)
- CI-Styling-System
- Landingpage-Builder mit BlÃ¶cken
- Formbuilder mit 18+ Feldtypen
- Dateimanager mit Berechtigungen

### Phase 3: Automation & Integration (ğŸ”„ In Arbeit)
- Aufgaben-System mit Auto-Triggern
- E-Mail-Marketing-Integration
- Social Media Posting
- API-Schnittstellen fÃ¼r Drittsysteme

### Phase 4: Advanced Features (ğŸ“‹ Geplant)
- KI-gestÃ¼tzte Lead-Bewertung
- Automatische A/B-Tests fÃ¼r Landingpages
- Erweiterte Analytics mit Predictive Modeling
- Mobile App fÃ¼r Mitarbeiter

---

## ğŸ“ Support & Dokumentation

### Benutzer-HandbÃ¼cher
- **Admin-Handbuch:** VollstÃ¤ndige Systemkonfiguration
- **Studioleiter-Guide:** TÃ¤gliche ArbeitsablÃ¤ufe
- **Mitarbeiter-Quick-Start:** Basis-Funktionen

### Technische Dokumentation
- **API-Referenz:** Alle Endpunkte dokumentiert
- **Datenbank-Schema:** ER-Diagramme und Beziehungen
- **Deployment-Guide:** Schritt-fÃ¼r-Schritt Installation

### Schulungen
- **Onboarding-Sessions** fÃ¼r neue Nutzer
- **Feature-Updates** bei neuen Releases
- **Best-Practice-Workshops** fÃ¼r optimale Nutzung

---

## ğŸ“ˆ Erfolgsmessung

### Business-KPIs
- **Lead-Conversion-Rate:** Target >15%
- **Kampagnen-ROI:** Target >300%
- **Mitarbeiter-Effizienz:** Aufgaben-Completion >90%
- **System-Adoption:** Daily Active Users >80%

### Technische Metriken
- **Page Load Time:** <2 Sekunden
- **System Uptime:** >99.5%
- **API Response Time:** <500ms
- **Error Rate:** <1%

### User Experience
- **Net Promoter Score (NPS):** Target >50
- **Feature Adoption Rate:** >70% nach 30 Tagen
- **Support Ticket Volume:** <5% der User pro Monat
- **Training Time:** <4 Stunden fÃ¼r neue Mitarbeiter

---

*Dieses PRD wird kontinuierlich aktualisiert basierend auf Nutzerfeedback und technischen Entwicklungen. Letzte Aktualisierung: Juni 2025*