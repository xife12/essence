---
description: 
globs: 
alwaysApply: true
---
# Modul: Landingpages & Webseitenvorlagen

## Zweck
Das Modul "Landingpages" ermöglicht es, für jede Kampagne individuelle, aber modular aufgebaute Webseiten zu erstellen. Dabei kommen Templates, verknüpfte Formular- und Testimonial-Vorlagen sowie wiederverwendbare Bausteine zum Einsatz. Die Bearbeitung erfolgt visuell und rollenbasiert innerhalb der Kampagne.

---

## Datenbankstruktur

### Tabelle: `public.landingpage_templates`
| Spalte      | Typ     | Beschreibung                        |
|-------------|----------|-------------------------------------|
| id          | UUID     | Primärschlüssel                     |
| name        | TEXT     | Template-Name                      |
| description | TEXT     | Beschreibung                       |
| sections    | JSONB    | Komponentenstruktur (Hero, CTA etc.) |
| created_at  | TIMESTAMP | Erstellzeitpunkt                   |
| updated_at  | TIMESTAMP | Letzte Änderung                    |

### Tabelle: `public.form_templates`
| Spalte     | Typ     | Beschreibung                  |
|------------|----------|-------------------------------|
| id         | UUID     | Primärschlüssel               |
| name       | TEXT     | Name des Formulars           |
| fields     | JSONB    | Felddefinitionen              |
| created_at | TIMESTAMP | Erstellt                      |
| updated_at | TIMESTAMP | Geändert                      |

### Tabelle: `public.testimonials`
| Spalte     | Typ     | Beschreibung             |
|------------|----------|--------------------------|
| id         | UUID     | Primärschlüssel          |
| name       | TEXT     | Name der Person          |
| quote      | TEXT     | Zitat/Meinung            |
| image_url  | TEXT     | Bild                     |
| role       | TEXT     | Funktion (z. B. Mitglied) |
| created_at | TIMESTAMP | Erstellt                 |
| updated_at | TIMESTAMP | Geändert                 |

### Tabelle: `public.campaign_pages`
| Spalte           | Typ     | Beschreibung                           |
|------------------|----------|----------------------------------------|
| id               | UUID     | Primärschlüssel                        |
| campaign_id      | UUID     | FK → campaigns.id                      |
| landingpage_id   | UUID     | FK → landingpage_templates.id         |
| form_id          | UUID     | FK → form_templates.id                |
| testimonial_ids  | UUID[]   | Testimonials, Mehrfachverknüpfung     |
| custom_sections  | JSONB    | User-spezifische Änderungen am Template |
| created_at       | TIMESTAMP | Erstellt                              |
| updated_at       | TIMESTAMP | Geändert                              |

---

## User Flow

1. **Zentrale Landingpage-Verwaltung (globale Bibliothek):**
   - Verwaltung aller Templates, Formularvorlagen und Testimonials
   - Rollen: Admin + Studioleiter

2. **Innerhalb der Kampagne:**
   - Auswahl bestehender Landingpage-Vorlage
   - Individualisierung durch:
     - Auswahl/Ersetzen des Formulars (aus `form_templates`)
     - Auswahl/Ersetzen von Testimonials (aus `testimonials`)
     - Bearbeiten von Text- und Bildabschnitten (custom_sections)
   - Veröffentlichung via Button "Landingpage aktivieren"

3. **Optionen für Benutzer:**
   - Änderung des Hero-Bereichs (z. B. Titel, Bild, CTA)
   - Auswahl von Testimonials über Such-/Filterfunktion
   - Formularfelder auswählen oder Vorlage duplizieren

4. **Drag & Drop (später optional):**
   - Visual Editor zur Umstrukturierung der Komponenten

---

## UI-Komponenten

- `LandingPageEditor`: Editor für Texte & Blöcke
- `TemplateSelector`: Auswahlbox mit Vorschau
- `TestimonialPicker`: Auswahl von Testimonials
- `FormSelector`: DropDown für Formulartemplates
- `SectionRenderer`: rendert dynamisch die gewählten Komponenten

---

## Rollen & Berechtigungen

| Rolle        | Zugriff                                          |
|--------------|--------------------------------------------------|
| Admin        | alle Templates & Kampagnenbearbeitung           |
| Studioleiter | Templates & Seiten für eigene Kampagnen         |
| Mitarbeiter  | keine Bearbeitung, nur Vorschau (optional)      |

---

## Hinweise für Cursor
- Kampagnenseite → Landingpage ist Pflicht, kann aber basierend auf Template individualisiert werden
- Template-Änderungen speichern `custom_sections`, nicht Original-Template überschreiben
- Testimonials und Formulare sind wiederverwendbare Entitäten (Verknüpfung per FK)
- Struktur basiert auf konfigurierbaren Abschnitten (Hero, Benefits, FAQ, Kontakt etc.)

---

## Verknüpfungen
- `campaign_pages.campaign_id` → `campaigns.id`
- `campaign_pages.landingpage_id` → `landingpage_templates.id`
- `campaign_pages.form_id` → `form_templates.id`
- `campaign_pages.testimonial_ids[]` → `testimonials.id`
- `form_templates.fields` → wird von Formular-Engine (Frontend) gerendert
- `custom_sections` → nur Unterschiede zum Template (Patch-Prinzip)
