
### Formular: Vertragsart anlegen/bearbeiten

Felder:

- Name (Pflicht)
- Beschreibung (optional)
- Laufzeit in Monaten (Zahleneingabe)
- Monatlicher Beitrag (€)
- Bonuszeitraum (optional)
- Automatische Verlängerung (Toggle)
  - Wenn aktiv → Verlängerungsdauer in Monaten
- Gruppenrabatt erlaubt? (Ja/Nein)
  - Wenn Ja: Eingabe Rabatt in Prozent (z. B. 10%)
- Zubuchbare Module erlaubt? (Ja/Nein)
  - Wenn Ja: Mehrfachauswahl mit Preis pro Modul
- Kostenfreie Module erlaubt? (Ja/Nein)
  - Wenn Ja: Mehrfachauswahl
- Aktiv (Checkbox)

---

## Vertragsmodule (eigener Bereich)

**Tabelle: `modules`**

| Spalte      | Typ             | Beschreibung                 |
|-------------|------------------|------------------------------|
| id          | UUID (PK)        | Modul-ID                     |
| name        | TEXT             | Modulname (z. B. „Sauna“)    |
| description | TEXT             | Erläuterung                  |
| created_at  | TIMESTAMP        | Anlagezeitpunkt              |

**Verwaltung:**  
- Zentrale Seite „Module“ → neue Module anlegen (Name, Beschreibung)
- Module können als „kostenfrei“ oder „kostenpflichtig“ mit Preis pro Vertrag zugewiesen werden
- Preis wird im Vertragstyp gespeichert

---

## Logik bei Mitgliedschaften

- Bei Auswahl eines Vertrags mit aktivem Gruppenrabatt:  
  → im Formular „Gruppenrabatt aktivieren“ (Ja/Nein)  
  → Rabatt in % wird automatisch auf `price_per_month` angewendet

- Zubuchbare Module → Checkbox + Preisberechnung in Mitgliedsvertrag
- Kostenfreie Module → als Text / Badge sichtbar

---

## Berechtigungen

| Rolle        | Berechtigung                            |
|--------------|------------------------------------------|
| Admin        | Vollzugriff                              |
| Studioleiter | Anlegen & Bearbeiten                     |
| Mitarbeiter  | keine Schreibrechte, nur Anzeige         |

---

## Hinweise für Cursor

- Formularlogik: bei aktivem Gruppenrabatt → Eingabefeld anzeigen
- Für Modulverknüpfung → relation table `contract_type_modules` verwenden
- Validierungen:
  - `term` > 0
  - `price_per_month` ≥ 0
  - Rabatt nur bei aktivierter Option
  - Nur aktive Vertragsarten bei Auswahl in `memberships`

