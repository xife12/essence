# ğŸ¯ VERTRAGSARTEN-SYSTEM V2 - ÃœBERSICHT

## ğŸ”„ TRANSFORMATION DES SYSTEMS

**Alter Zustand:** Einfache contract_types mit statischen Feldern  
**Neuer Zustand:** Umfassendes 3-Bereiche-System mit Versionierung und Kampagnenlogik

---

## ğŸ—ï¸ DIE 3 HAUPTBEREICHE

### ğŸ”¸ **A) VERTRÃ„GE** (vorher Vertragsarten)
- **Ãœbersicht:** Alle Vertragsarten mit Versionsanzeige
- **Erstellung:** + Neuer Vertrag mit erweiterten Einstellungen  
- **Versionierung:** Automatische Versionierung bei Ã„nderungen
- **KampagnenvertrÃ¤ge:** TemporÃ¤re Versionen fÃ¼r KampagnenzeitrÃ¤ume

### ğŸ”¸ **B) MODULE**
- **Ãœbersicht:** Kategorisierte Darstellung aller Module
- **Verwaltung:** + Modul hinzufÃ¼gen mit Icon und Kategorie
- **Schnellzuordnung:** Bulk-Assignment zu mehreren VertrÃ¤gen
- **Kategorien:** Training, Wellness, Premium, Digital, etc.

### ğŸ”¸ **C) VERTRAGSDOKUMENTE** 
- **Ãœbersicht:** Alle gespeicherten Vertragsdokumente
- **Editor:** WYSIWYG + Live PDF-Vorschau (Vollbild)
- **VerknÃ¼pfung:** Zuordnung zu einem oder mehreren VertrÃ¤gen
- **Abschnitte:** Strukturierte Dokumenterstellung

---

## ğŸ“‹ USERFLOWS

### **ğŸ”¸ STRANG A: VERTRÃ„GE**
```
Ãœbersicht â†’ + Neuer Vertrag â†’ Vertragseinstellungen â†’ Speichern
    â†“
Versionierung: Neue Version wird automatisch aktiviert
    â†“ 
Ã„nderungsnotiz: Automatisch generiert + manuell ergÃ¤nzbar
```

### **ğŸ”¸ STRANG A1: VERSIONIERUNG**
```
Vertrag bearbeiten â†’ Neue Version erstellen â†’ Ã„nderungsnotiz â†’ Speichern
    â†“
Alte Version: Bleibt parallel aktiv fÃ¼r bestehende Mitgliedschaften
    â†“
Neue Version: Wird fÃ¼r neue AbschlÃ¼sse aktiviert
```

### **ğŸ”¸ STRANG B: MODULE**
```
ModulÃ¼bersicht â†’ + Modul hinzufÃ¼gen â†’ Kategorie & Icon wÃ¤hlen
    â†“
Schnellzuordnung: Popup mit VertrÃ¤gen â†’ Enthalten/Zubuchbar â†’ Speichern
    â†“
Auto-Update: Alle zugeordneten VertrÃ¤ge werden aktualisiert
```

### **ğŸ”¸ STRANG C: VERTRAGSDOKUMENTE**
```
DokumentÃ¼bersicht â†’ + Dokument anlegen â†’ WYSIWYG-Editor (Vollbild)
    â†“
Abschnitte: + Abschnitt hinzufÃ¼gen â†’ Konfiguration â†’ Live PDF-Vorschau
    â†“
VerknÃ¼pfung: Einem oder mehreren VertrÃ¤gen zuordnen â†’ Speichern
```

---

## ğŸ›ï¸ NEUE FUNKTIONEN

### **Preisdynamik**
- **Einmalig:** Fester Betrag oder Prozentsatz
- **Stichtag:** 1. Monats oder manuelles Datum
- **Wiederholend:** Nach X Monaten, monatlich, jÃ¤hrlich
- **Mehrfach:** Mehrere Dynamiken pro Vertrag mÃ¶glich

### **Startpaket & Pauschalen**
- **Startpaket:** Einmaliger Betrag mit ModulverknÃ¼pfung
- **Pauschalen:** Mehrere hinzufÃ¼gbar mit verschiedenen Zyklen

### **KampagnenvertrÃ¤ge**
- **Duplikation:** Einstellungen werden dupliziert und anpassbar
- **Zeitraum:** Automatische Aktivierung/Deaktivierung
- **RÃ¼ckschaltung:** Nach Kampagnenende â†’ ursprÃ¼nglicher Vertrag
- **VerlÃ¤ngerung:** Neue Kampagnenversion mit VerlÃ¤ngerungs-Flag

### **Vertragsdokumente**
- **WYSIWYG-Editor:** Vollbild mit Live-Vorschau
- **Abschnitte:** Ãœberschrift, Inhalt, Verpflichtend, Unterschrift
- **Darstellung:** Als Checkbox, normale Ansicht
- **Integration:** Abbuchungskalender, Leistungsinhalt, Stammdaten

---

## ğŸ”— SYSTEMINTEGRATIONEN

### **Mitgliedschaften**
- Vertragsauswahl zeigt aktive Versionen
- KampagnenvertrÃ¤ge werden erkannt
- Preisdynamik wird in Beitragsberechnung einbezogen
- Startpaket wird bei Vertragsabschluss berÃ¼cksichtigt

### **Kampagnen**
- KampagnenvertrÃ¤ge werden automatisch erstellt
- Zeitgesteuerte Aktivierung basierend auf Kampagnenlaufzeit
- VerlÃ¤ngerungslogik fÃ¼r Kampagnen integriert

### **Beratung & Leads**
- Aktualisierte Vertragsauswahl in Formularen
- KampagnenvertrÃ¤ge in BeratungsgesprÃ¤chen verfÃ¼gbar
- Preisvorschau mit dynamischen Berechnungen

### **Dateimanager**
- Modul-Icons aus Asset-Verwaltung
- Vertragsdokument-Assets (Logos, Header-Bilder)
- PDF-Template-Verwaltung

---

## ğŸ“Š DATENSTRUKTUR-ÃœBERSICHT

### **Neue Haupttabellen**
- `contracts` (VertrÃ¤ge mit Versionierung)
- `contract_pricing` (Preisdynamiken)
- `contract_modules` (Module mit Kategorien)  
- `contract_documents` (WYSIWYG-Dokumente)
- `contract_document_sections` (Dokumentabschnitte)

### **Beziehungstabellen**
- `contract_module_assignments` (Modul â†” Vertrag)
- `contract_document_assignments` (Dokument â†” Vertrag)
- `contract_terms` (Laufzeiten pro Vertrag)
- `contract_starter_packages` (Startpakete)
- `contract_flat_rates` (Pauschalen)

---

## ğŸ¨ UI/UX KONZEPT

### **Navigation**
```
Vertragsarten (Hauptbereich)
â”œâ”€â”€ VertrÃ¤ge (Standard-Tab)
â”œâ”€â”€ Module 
â””â”€â”€ Vertragsdokumente
```

### **Ãœbersichtstabellen**
- **Filter:** Aktiv/Inaktiv, Kampagne, Kategorie
- **Suche:** Nach Name, Beschreibung
- **Aktionen:** Bearbeiten, Versionierung, Auswertung, Duplizieren

### **Spezial-Views**
- **Versionierungs-Modal:** Historie mit Ã„nderungsnotizen
- **Schnellzuordnung:** Matrix-View fÃ¼r Module â†” VertrÃ¤ge
- **Dokument-Editor:** Split-Screen WYSIWYG + PDF-Vorschau

---

## âš¡ LEISTUNGSMERKMALE

### **Versionierung**
- Parallele Vertragsversionen ohne Datenverlust
- Automatische und manuelle Ã„nderungsnotizen
- Historien-Tracking fÃ¼r Compliance

### **Kampagnenlogik**
- Zeitgesteuerte Vertragsaktivierung
- Vererbung von Basis-Einstellungen
- Automatische RÃ¼ckschaltung

### **ModulflexibilitÃ¤t**
- Kategorisierte Organisation
- Bulk-Zuordnung zu VertrÃ¤gen
- Icon-basierte Darstellung

### **Dokumentenerstellung**
- WYSIWYG-Editor mit Live-Vorschau
- Modulare Abschnitte
- PDF-Export-Ready

---

## ğŸš€ ROLLOUT-PHASEN

1. **Infrastruktur:** Datenbank + API (3-4 Tage)
2. **Business Logic:** Versionierung + Kampagnen (4-5 Tage)  
3. **User Interface:** 3 Hauptbereiche (5-6 Tage)
4. **Integration:** Bestehende Module (2-3 Tage)
5. **Testing & Go-Live:** Validierung + Rollout (2-3 Tage)

**Gesamt: 16-21 Arbeitstage**